This file gives you instructions on how to migrate from one version of
OpenDNSSEC to another.

*** Fix for MySQL zone delete issue ***

  As reported in:
    https://issues.opendnssec.org/browse/OPENDNSSEC-338

  This effects MySQL databases created after 1.4.0a3 or 1.3.9 where zone deletion was changed.

  If you wish to fix this without losing any existing information then run the sql statements
  given in:

    enforcer/utils/migrate_zone_delete.mysql

  against your database.

  Note that sqlite is not effected as we do not enforce any constraints.



*** Adding indexes to kasp (sqlite3 only) ***

  This is not really a migration as it is not required, but it improves performance
  (at the cost of a slight increase in database file size).
  
  sqlite3 databases created prior to the 1.3.8 release will not have indexes on 
  foreign keys. This can be fixed by running the following command:

	sqlite3 [PATH_TO_KASP_DB] < enforcer/utils/add_indexes.sqlite3



*** Migrating from v1.2 to v1.3 ***

  There are no migration scripts to run to make this transition.


*** Migrating from v1.1 to v1.2 ***

  There is a kasp schema change from the 1.1 branch (or trunk if you built
  prior to r3823). To make this transition you have 2 options:

  1) Run ods-ksmutil setup again. This will remove _all_ the current
  information from the kasp database and start you off again with a fresh
  environment.

  If that is not an option, or you want to try something else then:

  2) run one of the migration scripts
        enforcer/utils/migrate_keyshare_mysql.pl
  or
        enforcer/utils/migrate_keyshare_sqlite3.pl
  depending on your database.

  NOTE: Although these scripts have been tested it is recommended to make a
        backup of your database prior to running them.




*** Migrating to a larger keypairs(id) field (MySQL ONLY) ***

  The version of the MySQL database that was created with v1.2 (and prior to
  svn r4465) had a smallint datatype for the keypairs(id) field. This limits
  the number of keys that the system can store to 32767.

  If this number is not large enough then the script:

  enforcer/utils/migrate_id_mysql.pl

  will increase it to an int, which can store 2147483647 keys.

  NOTES: Although this scripts have been tested it is recommended to make a
         backup of your database prior to running them.

		 This issue only applies to MySQL backends.
